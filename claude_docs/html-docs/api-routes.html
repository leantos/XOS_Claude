<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVS API Routes Reference</title>
    <link rel="icon" type="image/png" href="xos-docs.png">
    <link rel="shortcut icon" type="image/png" href="xos-docs.png">
    <link rel="apple-touch-icon" href="xos-docs.png">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-dark.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <!-- Theme Toggle Button -->
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                <i class="bi bi-moon-fill" id="theme-icon"></i>
                <span id="theme-text">Dark</span>
            </button>
            
            <h3><i class="bi bi-lightning-charge"></i> Quick Access</h3>
            <ul>
                <li><a href="index.html"><i class="bi bi-house"></i> Documentation Hub</a></li>
                <li><a href="#controller-registry"><i class="bi bi-list-ul"></i> Controller Registry</a></li>
                <li><a href="#authentication"><i class="bi bi-shield-check"></i> Authentication</a></li>
                <li><a href="#common-responses"><i class="bi bi-arrow-return-left"></i> Response Formats</a></li>
            </ul>
            
            <h3><i class="bi bi-server"></i> Controllers</h3>
            <ul>
                <li><a href="#authentication"><i class="bi bi-key"></i> Authentication (API-01)</a></li>
                <li><a href="#opera-audit"><i class="bi bi-file-text"></i> Opera Audit (API-02)</a></li>
                <li><a href="#bank-reconciliation"><i class="bi bi-bank"></i> Bank Reconciliation (API-03)</a></li>
                <li><a href="#refund-management"><i class="bi bi-arrow-counterclockwise"></i> Refund Management (API-04)</a></li>
                <li><a href="#bacs-refund"><i class="bi bi-bank2"></i> BACS Refund (API-05)</a></li>
                <li><a href="#dashboard"><i class="bi bi-speedometer2"></i> Dashboard (API-06)</a></li>
                <li><a href="#reports"><i class="bi bi-graph-up"></i> Reports (API-07)</a></li>
                <li><a href="#user-master"><i class="bi bi-person-gear"></i> User Master (API-08)</a></li>
                <li><a href="#site-management"><i class="bi bi-building"></i> Site Management (API-09)</a></li>
                <li><a href="#workflow"><i class="bi bi-arrow-repeat"></i> Workflow (API-10)</a></li>
            </ul>
            
            <h3><i class="bi bi-gear"></i> Configuration</h3>
            <ul>
                <li><a href="#base-config"><i class="bi bi-wrench"></i> Base Configuration</a></li>
                <li><a href="#request-headers"><i class="bi bi-card-heading"></i> Request Headers</a></li>
                <li><a href="#status-codes"><i class="bi bi-hash"></i> HTTP Status Codes</a></li>
                <li><a href="#rate-limiting"><i class="bi bi-stopwatch"></i> Rate Limiting</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">

            <h1><i class="bi bi-cloud-arrow-up-fill"></i> CVS API Routes Reference</h1>

            <div class="alert alert-info">
                <h3><i class="bi bi-info-circle"></i> API Design Principles</h3>
                <p>This API follows modern enterprise patterns including statelessness, loose coupling, scalability, and security-first design.</p>
            </div>

            <section id="api-principles">
                <h2>API Design Principles</h2>
                
                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Core Principles</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <ul>
                            <li><strong>Statelessness</strong>: JWTs for sessions with refresh tokens; idempotent write operations</li>
                            <li><strong>Loose coupling</strong>: API Gateway pattern, spec-first design (OpenAPI), abstracted DB schema</li>
                            <li><strong>Scalability</strong>: Cursor pagination, bulk endpoints, async processing for heavy operations</li>
                            <li><strong>Resilience</strong>: Request timeouts, retries with idempotency keys, circuit breakers</li>
                            <li><strong>Observability</strong>: Trace IDs (X-Request-Id), structured logging (Serilog), per-endpoint metrics</li>
                            <li><strong>Security</strong>: TLS enforced, JWT Bearer auth with refresh tokens, RBAC, input sanitization</li>
                            <li><strong>Automation</strong>: CI/CD with schema validation & contract tests</li>
                            <li><strong>Cost-awareness</strong>: Response caching for GETs, payload size limits</li>
                            <li><strong>Evolvability</strong>: API versioning (/api/v1/), deprecation policy with notices</li>
                            <li><strong>Consistency</strong>: Strong consistency for financial data; eventual for reports; ETags for caching</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="base-config">
                <h2>Base Configuration</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Configuration</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Base URL</strong></td>
                                <td><code>https://localhost:5139/api</code></td>
                            </tr>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>JWT Bearer Token</td>
                            </tr>
                            <tr>
                                <td><strong>Content-Type</strong></td>
                                <td>application/json</td>
                            </tr>
                            <tr>
                                <td><strong>CORS</strong></td>
                                <td>Configured in appsettings.json</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="controller-registry">
                <h2>Controller Registry</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Controller</th>
                                <th>Base Route</th>
                                <th>Auth Required</th>
                                <th>Service Dependency</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-primary">API-01</span></td>
                                <td>AuthController</td>
                                <td><code>/api/auth</code></td>
                                <td>No (login only)</td>
                                <td>UserService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-02</span></td>
                                <td>OperaIncomeAuditController</td>
                                <td><code>/api/operaincomeaudit</code></td>
                                <td>Yes</td>
                                <td>OperaIncomeAuditService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-03</span></td>
                                <td>BankReconciliationController</td>
                                <td><code>/api/bankreconciliation</code></td>
                                <td>Yes</td>
                                <td>BankReconciliationService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-04</span></td>
                                <td>RefundController</td>
                                <td><code>/api/refund</code></td>
                                <td>Yes</td>
                                <td>RefundService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-05</span></td>
                                <td>BacsRefundController</td>
                                <td><code>/api/bacsrefund</code></td>
                                <td>Yes</td>
                                <td>BacsRefundService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-06</span></td>
                                <td>DashboardController</td>
                                <td><code>/api/dashboard</code></td>
                                <td>Yes</td>
                                <td>DashboardService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-07</span></td>
                                <td>ReportController</td>
                                <td><code>/api/report</code></td>
                                <td>Yes</td>
                                <td>ReportService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-08</span></td>
                                <td>UserMasterController</td>
                                <td><code>/api/usermaster</code></td>
                                <td>Yes</td>
                                <td>UserMasterService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-09</span></td>
                                <td>SiteController</td>
                                <td><code>/api/site</code></td>
                                <td>Yes</td>
                                <td>SiteService</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-primary">API-10</span></td>
                                <td>WorkFlowMasterController</td>
                                <td><code>/api/workflowmaster</code></td>
                                <td>Yes</td>
                                <td>WorkFlowMasterService</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="authentication">
                <h2>Authentication Endpoints (API-01)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Request Body</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/auth/login</code></td>
                                <td>User login</td>
                                <td><code>{username, password, siteId}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/auth/refresh</code></td>
                                <td>Refresh token</td>
                                <td><code>{refreshToken}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/auth/logout</code></td>
                                <td>User logout</td>
                                <td><code>{userId}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/auth/validate</code></td>
                                <td>Validate token</td>
                                <td>Headers only</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="opera-audit">
                <h2>Opera Income Audit (API-02)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/operaincomeaudit/list</code></td>
                                <td>Get audit list</td>
                                <td><code>?pageNo&pageSize&status</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/operaincomeaudit/{id}</code></td>
                                <td>Get audit details</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/operaincomeaudit/create</code></td>
                                <td>Create audit</td>
                                <td>Body: OperaIncomeAudit</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">PUT</span></td>
                                <td><code>/operaincomeaudit/update</code></td>
                                <td>Update audit</td>
                                <td>Body: OperaIncomeAudit</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/operaincomeaudit/autofill</code></td>
                                <td>Auto-fill data</td>
                                <td><code>{clientId, siteId}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/operaincomeaudit/submit</code></td>
                                <td>Submit for approval</td>
                                <td><code>{workflowId, comments}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/operaincomeaudit/report/{id}</code></td>
                                <td>Generate report</td>
                                <td><code>id: int</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="bank-reconciliation">
                <h2>Bank Reconciliation (API-03)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/bankreconciliation/list</code></td>
                                <td>List reconciliations</td>
                                <td><code>?startDate&endDate</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bankreconciliation/import</code></td>
                                <td>Import statement</td>
                                <td>FormData: file</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bankreconciliation/match</code></td>
                                <td>Match transactions</td>
                                <td>Body: MatchRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/bankreconciliation/unmatched</code></td>
                                <td>Get unmatched</td>
                                <td><code>?reconciliationId</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bankreconciliation/complete</code></td>
                                <td>Complete reconciliation</td>
                                <td><code>{reconciliationId}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="refund-management">
                <h2>Refund Management (API-04)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/refund/list</code></td>
                                <td>List refunds</td>
                                <td><code>?status&dateFrom&dateTo</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/refund/{id}</code></td>
                                <td>Get refund details</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/refund/create</code></td>
                                <td>Create refund</td>
                                <td>Body: RefundRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">PUT</span></td>
                                <td><code>/refund/update</code></td>
                                <td>Update refund</td>
                                <td>Body: RefundRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/refund/approve</code></td>
                                <td>Approve refund</td>
                                <td><code>{refundId, comments}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/refund/reject</code></td>
                                <td>Reject refund</td>
                                <td><code>{refundId, reason}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="bacs-refund">
                <h2>BACS Refund Management (API-05)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/bacsrefund/list</code></td>
                                <td>List BACS refunds</td>
                                <td><code>?status&dateFrom&dateTo</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/bacsrefund/{id}</code></td>
                                <td>Get BACS refund details</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bacsrefund/create</code></td>
                                <td>Create BACS refund</td>
                                <td>Body: BacsRefundRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">PUT</span></td>
                                <td><code>/bacsrefund/update</code></td>
                                <td>Update BACS refund</td>
                                <td>Body: BacsRefundRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bacsrefund/process</code></td>
                                <td>Process BACS file</td>
                                <td>FormData: file</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/bacsrefund/validate</code></td>
                                <td>Validate BACS data</td>
                                <td><code>{refundIds}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="dashboard">
                <h2>Dashboard (API-06)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/dashboard/metrics</code></td>
                                <td>Get metrics</td>
                                <td><code>?period&siteId</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/dashboard/pending</code></td>
                                <td>Pending items</td>
                                <td><code>?userId</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/dashboard/charts</code></td>
                                <td>Chart data</td>
                                <td><code>?chartType&period</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/dashboard/alerts</code></td>
                                <td>Active alerts</td>
                                <td><code>?severity</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="reports">
                <h2>Reports (API-07)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/report/list</code></td>
                                <td>Available reports</td>
                                <td><code>?category</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/report/generate</code></td>
                                <td>Generate report</td>
                                <td>Body: ReportRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/report/download/{id}</code></td>
                                <td>Download report</td>
                                <td><code>id: guid</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/report/schedule</code></td>
                                <td>Schedule report</td>
                                <td>Body: ScheduleRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/report/history</code></td>
                                <td>Report history</td>
                                <td><code>?userId&dateFrom</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="user-master">
                <h2>User Master Management (API-08)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/usermaster/list</code></td>
                                <td>List users</td>
                                <td><code>?pageNo&pageSize&status</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/usermaster/{id}</code></td>
                                <td>Get user details</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/usermaster/create</code></td>
                                <td>Create user</td>
                                <td>Body: UserMasterRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">PUT</span></td>
                                <td><code>/usermaster/update</code></td>
                                <td>Update user</td>
                                <td>Body: UserMasterRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-danger">DELETE</span></td>
                                <td><code>/usermaster/{id}</code></td>
                                <td>Delete user</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/usermaster/resetpassword</code></td>
                                <td>Reset password</td>
                                <td><code>{userId, newPassword}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="site-management">
                <h2>Site Management (API-09)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/site/list</code></td>
                                <td>List sites</td>
                                <td><code>?active&region</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/site/{id}</code></td>
                                <td>Get site details</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/site/create</code></td>
                                <td>Create site</td>
                                <td>Body: SiteRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">PUT</span></td>
                                <td><code>/site/update</code></td>
                                <td>Update site</td>
                                <td>Body: SiteRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/site/activate</code></td>
                                <td>Activate site</td>
                                <td><code>{siteId}</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/site/deactivate</code></td>
                                <td>Deactivate site</td>
                                <td><code>{siteId, reason}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="workflow">
                <h2>Workflow Management (API-10)</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Route</th>
                                <th>Purpose</th>
                                <th>Parameters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/workflowmaster/pending</code></td>
                                <td>Pending approvals</td>
                                <td><code>?userId</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/workflowmaster/route</code></td>
                                <td>Route workflow</td>
                                <td>Body: RoutingRequest</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-info">GET</span></td>
                                <td><code>/workflowmaster/history/{id}</code></td>
                                <td>Workflow history</td>
                                <td><code>id: int</code></td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">POST</span></td>
                                <td><code>/workflowmaster/reassign</code></td>
                                <td>Reassign workflow</td>
                                <td><code>{workflowId, newUserId}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="common-responses">
                <h2>Common Response Formats</h2>
                
                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Success Response</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Success Response Format</span>
                                <button class="copy-btn" onclick="copyCode(this, 'success-response')">Copy</button>
                            </div>
                            <pre><code id="success-response" class="language-json">{
  "success": true,
  "data": {...},
  "message": "Operation successful"
}</code></pre>
                        </div>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Error Response</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Error Response Format</span>
                                <button class="copy-btn" onclick="copyCode(this, 'error-response')">Copy</button>
                            </div>
                            <pre><code id="error-response" class="language-json">{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Error description",
    "details": {...}
  }
}</code></pre>
                        </div>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Paginated Response</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Paginated Response Format</span>
                                <button class="copy-btn" onclick="copyCode(this, 'paginated-response')">Copy</button>
                            </div>
                            <pre><code id="paginated-response" class="language-json">{
  "success": true,
  "data": {
    "items": [...],
    "pageNumber": 1,
    "pageSize": 20,
    "totalRecords": 100,
    "totalPages": 5
  }
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <section id="status-codes">
                <h2>HTTP Status Codes</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Meaning</th>
                                <th>Usage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-success">200</span></td>
                                <td>OK</td>
                                <td>Successful GET/PUT</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-success">201</span></td>
                                <td>Created</td>
                                <td>Successful POST</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-secondary">204</span></td>
                                <td>No Content</td>
                                <td>Successful DELETE</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">400</span></td>
                                <td>Bad Request</td>
                                <td>Invalid input</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">401</span></td>
                                <td>Unauthorized</td>
                                <td>Missing/invalid token</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">403</span></td>
                                <td>Forbidden</td>
                                <td>Insufficient permissions</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">404</span></td>
                                <td>Not Found</td>
                                <td>Resource not found</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-warning">409</span></td>
                                <td>Conflict</td>
                                <td>Business rule violation</td>
                            </tr>
                            <tr>
                                <td><span class="badge badge-danger">500</span></td>
                                <td>Server Error</td>
                                <td>Unhandled exception</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="request-headers">
                <h2>Request Headers</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Header</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>Authorization</code></td>
                                <td><span class="badge badge-critical">Yes*</span></td>
                                <td>Bearer {token}</td>
                            </tr>
                            <tr>
                                <td><code>Content-Type</code></td>
                                <td><span class="badge badge-critical">Yes</span></td>
                                <td>application/json</td>
                            </tr>
                            <tr>
                                <td><code>X-Client-Id</code></td>
                                <td><span class="badge badge-critical">Yes</span></td>
                                <td>Client identifier</td>
                            </tr>
                            <tr>
                                <td><code>X-Site-Id</code></td>
                                <td><span class="badge badge-critical">Yes</span></td>
                                <td>Site identifier</td>
                            </tr>
                            <tr>
                                <td><code>X-Request-Id</code></td>
                                <td><span class="badge badge-secondary">No</span></td>
                                <td>Request tracking</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p><small>*Not required for <code>/auth/login</code></small></p>
            </section>

            <section id="query-parameters">
                <h2>Query Parameters Convention</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>pageNo</code></td>
                                <td>int</td>
                                <td>Page number (1-based)</td>
                            </tr>
                            <tr>
                                <td><code>pageSize</code></td>
                                <td>int</td>
                                <td>Items per page (max 100)</td>
                            </tr>
                            <tr>
                                <td><code>sortBy</code></td>
                                <td>string</td>
                                <td>Field to sort by</td>
                            </tr>
                            <tr>
                                <td><code>sortOrder</code></td>
                                <td>string</td>
                                <td>asc/desc</td>
                            </tr>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search term</td>
                            </tr>
                            <tr>
                                <td><code>status</code></td>
                                <td>string</td>
                                <td>Filter by status</td>
                            </tr>
                            <tr>
                                <td><code>dateFrom</code></td>
                                <td>date</td>
                                <td>Start date (yyyy-MM-dd)</td>
                            </tr>
                            <tr>
                                <td><code>dateTo</code></td>
                                <td>date</td>
                                <td>End date (yyyy-MM-dd)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="file-uploads">
                <h2>File Upload Endpoints</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Controller</th>
                                <th>Route</th>
                                <th>File Type</th>
                                <th>Max Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>BankReconciliation</td>
                                <td><code>/import</code></td>
                                <td>CSV, PDF</td>
                                <td>10MB</td>
                            </tr>
                            <tr>
                                <td>OperaIncomeAudit</td>
                                <td><code>/upload</code></td>
                                <td>XLS, XLSX</td>
                                <td>5MB</td>
                            </tr>
                            <tr>
                                <td>Report</td>
                                <td><code>/template/upload</code></td>
                                <td>HTML</td>
                                <td>2MB</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="websocket-hubs">
                <h2>WebSocket/SignalR Hubs</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Hub</th>
                                <th>Route</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>NotificationsHub</td>
                                <td><code>/hubs/notifications</code></td>
                                <td>Real-time notifications</td>
                            </tr>
                            <tr>
                                <td>DashboardHub</td>
                                <td><code>/hubs/dashboard</code></td>
                                <td>Dashboard updates</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="rate-limiting">
                <h2>Rate Limiting</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Endpoint Type</th>
                                <th>Limit</th>
                                <th>Window</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Authentication</td>
                                <td>5 requests</td>
                                <td>1 minute</td>
                            </tr>
                            <tr>
                                <td>File Upload</td>
                                <td>10 requests</td>
                                <td>5 minutes</td>
                            </tr>
                            <tr>
                                <td>Report Generation</td>
                                <td>20 requests</td>
                                <td>1 hour</td>
                            </tr>
                            <tr>
                                <td>General API</td>
                                <td>100 requests</td>
                                <td>1 minute</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="best-practices">
                <h2>API Design Best Practices</h2>
                
                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Request/Response Patterns</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <ul>
                            <li><strong>Idempotency</strong>: All PUT/DELETE operations are idempotent</li>
                            <li><strong>Bulk Operations</strong>: Support batch processing for efficiency</li>
                            <li><strong>Async Processing</strong>: Long-running operations return 202 Accepted with status URL</li>
                            <li><strong>Partial Updates</strong>: PATCH support for resource modifications</li>
                        </ul>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Error Handling Model</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
                            <div class="code-header">
                                <span>Error Response Model</span>
                                <button class="copy-btn" onclick="copyCode(this, 'error-model')">Copy</button>
                            </div>
                            <pre><code id="error-model" class="language-json">{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid input data",
    "details": [
      {"field": "amount", "message": "Must be greater than 0"}
    ],
    "requestId": "trace-xyz-123",
    "timestamp": "2025-01-15T10:30:00Z"
  }
}</code></pre>
                        </div>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>API Versioning Strategy</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <ul>
                            <li><strong>URL Versioning</strong>: <code>/api/v1/</code>, <code>/api/v2/</code></li>
                            <li><strong>Deprecation Notice</strong>: 6-month warning period</li>
                            <li><strong>Backward Compatibility</strong>: Maintain for minimum 12 months</li>
                            <li><strong>Version Headers</strong>: <code>X-API-Version</code> for version info</li>
                        </ul>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Performance Optimization</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <ul>
                            <li><strong>ETag Support</strong>: Conditional requests for caching</li>
                            <li><strong>Compression</strong>: gzip/deflate for responses > 1KB</li>
                            <li><strong>Field Filtering</strong>: <code>?fields=id,name,status</code> for partial responses</li>
                            <li><strong>Pagination</strong>: Cursor-based for large datasets</li>
                        </ul>
                    </div>
                </div>

                <div class="collapsible">
                    <div class="collapsible-header" onclick="toggleCollapsible(this)">
                        <h3>Security Measures</h3>
                        <span class="collapsible-toggle">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <ul>
                            <li><strong>API Key Management</strong>: Service-to-service auth via X-API-Key</li>
                            <li><strong>Request Signing</strong>: HMAC-SHA256 for sensitive operations</li>
                            <li><strong>Input Validation</strong>: Strict schema validation on all inputs</li>
                            <li><strong>Output Sanitization</strong>: XSS prevention in all responses</li>
                        </ul>
                    </div>
                </div>
            </section>

            <div class="footer">
                <p><em>API Documentation Version: 1.0.0</em><br>
                <em>Last Updated: August 21, 2025</em><br>
                <em>Base URL: https://localhost:5139/api</em></p>
                
                <p><strong>Need Help?</strong> Check the <a href="index.html">Documentation Hub</a> for troubleshooting guides and development workflows</p>
            </div>
        </main>
    </div>

    <script>
        // Copy code functionality
        function copyCode(button, codeId) {
            const codeElement = document.getElementById(codeId);
            const text = codeElement.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Collapsible sections
        function toggleCollapsible(header) {
            const collapsible = header.parentElement;
            collapsible.classList.toggle('expanded');
        }

        // Search functionality
        function highlightText(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const content = document.querySelector('.main-content');
            const sections = content.querySelectorAll('section, h2, h3, p, li, td, code');
            
            // Remove previous highlights
            sections.forEach(section => {
                section.innerHTML = section.innerHTML.replace(/<span class="highlight">(.*?)<\/span>/gi, '$1');
            });
            
            if (searchTerm.length > 2) {
                sections.forEach(section => {
                    const text = section.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        section.innerHTML = highlightText(section.innerHTML, searchTerm);
                    }
                });
            }
        });

        // Mobile sidebar toggle
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }

        // Add mobile menu button for smaller screens
        if (window.innerWidth <= 768) {
            const menuButton = document.createElement('button');
            menuButton.innerHTML = 'â˜° Menu';
            menuButton.style.cssText = 'position: fixed; top: 1rem; left: 1rem; z-index: 200; padding: 0.5rem; background: var(--primary-color); color: white; border: none; border-radius: 0.25rem; cursor: pointer;';
            menuButton.onclick = toggleSidebar;
            document.body.appendChild(menuButton);
        }

        // Auto-expand sections with search results
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length > 2) {
                document.querySelectorAll('.collapsible').forEach(collapsible => {
                    const text = collapsible.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        collapsible.classList.add('expanded');
                    }
                });
            }
        });

        // Theme Toggle Functionality - Fluent 2 Design System
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');
            const currentTheme = body.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                body.setAttribute('data-theme', 'light');
                themeIcon.className = 'bi bi-sun-fill';
                themeText.textContent = 'Light';
                localStorage.setItem('preferred-theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'bi bi-moon-fill';
                themeText.textContent = 'Dark';
                localStorage.setItem('preferred-theme', 'dark');
            }
        }

        // Load saved theme preference or default to dark
        function loadTheme() {
            const savedTheme = localStorage.getItem('preferred-theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');
            
            body.setAttribute('data-theme', theme);
            
            if (theme === 'light') {
                themeIcon.className = 'bi bi-sun-fill';
                themeText.textContent = 'Light';
            } else {
                themeIcon.className = 'bi bi-moon-fill';
                themeText.textContent = 'Dark';
            }
        }

        // Initialize theme on page load
        document.addEventListener('DOMContentLoaded', loadTheme);

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (!localStorage.getItem('preferred-theme')) {
                loadTheme();
            }
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>