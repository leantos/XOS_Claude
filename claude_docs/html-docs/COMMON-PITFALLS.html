<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMMON-PITFALLS - XOS Framework</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-dark.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <h3><i class="bi bi-arrow-left"></i> Quick Links</h3>
            <ul>
                <li><a href="README.html"><i class="bi bi-house"></i> Documentation Hub</a></li>
                <li><a href="CRITICAL_PATTERNS.html"><i class="bi bi-exclamation-triangle"></i> Critical Patterns</a></li>
                <li><a href="MODULE-DEVELOPMENT-GUIDE.html"><i class="bi bi-book"></i> Module Guide</a></li>
                <li><a href="SETUP.html"><i class="bi bi-gear"></i> Setup Guide</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <p># ?? COMMON PITFALLS - What Breaks Everything and How to Fix It</p><p><h2>Quick Error Lookup</h2></p><p><strong>Got an error?</strong> Use Ctrl+F to search for your error message below.</p><p>---</p><p><h2>?? FRONTEND ERRORS</h2></p><p><h3>? "Cannot set property Data of #<VMBase>"</h3></p><p><strong>What it means</strong>: You're trying to replace the Data object instead of modifying its properties.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - This throws the error
init() {
    this.Data = { userName: '', email: '' };  // Trying to replace Data
}</p><p>// ? ALSO WRONG
someMethod() {
    this.VM.Data = { newProperty: 'value' };  // Trying to replace Data
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Get reference to Data, then modify properties
init() {
    const model = this.Data;     // Get reference
    model.userName = '';         // Modify properties
    model.email = '';
    model.isLoading = false;
}</p><p>// For updates
someMethod() {
    const model = this.VM.Data;
    model.newProperty = 'value';
    this.VM.updateUI();
}
</code></pre></div></p><p><strong>Reference</strong>: <code>frontend/viewmodel-complete.jsx</code> lines 20-50</p><p>---</p><p><h3>? "Textbox not accepting keyboard input" / "Input is read-only"</h3></p><p><strong>What it means</strong>: The three-step event handler pattern is missing or incorrect.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - Missing updateUI()
handleInputChange = (e) => {
    this.VM.Data[e.name] = e.value;  // Direct access + no updateUI()
};</p><p>// ? WRONG - Using e.target.value
handleInputChange = (e) => {
    const model = this.VM.Data;
    model[e.name] = e.target.value;  // Should be e.value
    this.VM.updateUI();
};</p><p>// ? WRONG - Missing name prop
<cntrl.XOSTextbox
    value={data.userName}
    onChange={this.handleInputChange}  // No name prop!
/>
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Perfect three-step pattern
handleInputChange = (e) => {
    if (this.VM) {                    // Step 1: Check VM
        const model = this.VM.Data;   // Step 2: Get reference
        model[e.name] = e.value;      // Step 3: Use e.value
        this.VM.updateUI();           // Step 4: Update UI
    }
};</p><p>// Component must have name prop
<cntrl.XOSTextbox
    name="userName"                   // REQUIRED
    value={data.userName || ''}
    onChange={this.handleInputChange}
/>
</code></pre></div></p><p><strong>Reference</strong>: <code>frontend/component-complete.jsx</code> lines 200-300</p><p>---</p><p><h3>? "Cannot resolve module '../../xos-components/XOSComponent.js'"</h3></p><p><strong>What it means</strong>: Wrong import pattern for XOS components.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG import patterns
import { XOSComponent } from '../../xos-components/XOSComponent.js';
import XOSComponent from '../../xos-components';
import { XOSTextbox } from '../../xos-components/XOSTextbox';
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// ALWAYS use this exact import
import <em> as cntrl from '../../xos-components';</p><p>// Then use as:
export default class MyComponent extends cntrl.XOSComponent {
    // ...
}</p><p><cntrl.XOSTextbox ... />
<cntrl.XOSCombobox ... />
</code></pre></div></p><p><strong>Reference</strong>: <code>frontend/component-complete.jsx</code> lines 1-10</p><p>---</p><p><h3>? "UI not re-rendering after state changes"</h3></p><p><strong>What it means</strong>: Missing <code>updateUI()</code> calls after data modifications.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - UI won't reflect changes
saveData() {
    this.VM.Data.isLoading = true;  // Changed data but no updateUI()
    
    // API call
    Utils.ajax({ ... }).then(() => {
        this.VM.Data.isLoading = false;  // Still no updateUI()
        this.VM.Data.message = 'Saved!';
    });
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Always call updateUI() after changing Data
saveData() {
    this.VM.Data.isLoading = true;
    this.VM.updateUI();  // Update after each change
    
    Utils.ajax({ ... }).then(() => {
        this.VM.Data.isLoading = false;
        this.VM.Data.message = 'Saved!';
        this.VM.updateUI();  // Update again
    });
}
</code></pre></div></p><p><strong>Reference</strong>: <code>frontend/viewmodel-complete.jsx</code> lines 200-250</p><p>---</p><p><h3>? "TypeError: Cannot read property 'Data' of undefined"</h3></p><p><strong>What it means</strong>: ViewModel not properly passed to component constructor.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - VM not passed to super
export default class MyComponent extends cntrl.XOSComponent {
    constructor(props) {
        super(props);  // Missing VM parameter
    }
}</p><p>// ? WRONG - VM not instantiated
export default class MyComponent extends cntrl.XOSComponent {
    constructor(props) {
        super(props, MyComponentVM);  // Should be: new MyComponentVM(props)
    }
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Always pass new VM instance to super
export default class MyComponent extends cntrl.XOSComponent {
    constructor(props) {
        super(props, new MyComponentVM(props));  // CORRECT
    }
}
</code></pre></div></p><p><strong>Reference</strong>: <code>frontend/component-complete.jsx</code> lines 15-25</p><p>---</p><p><h2>?? BACKEND ERRORS</h2></p><p><h3>? "Column 'column_name' does not exist"</h3></p><p><strong>What it means</strong>: Using wrong database access pattern, case sensitivity issues.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>csharp
// ? WRONG - These will fail
return new Entity {
    ID = row["ID"],           // Case sensitive!
    Name = row["Name"],       // Might not exist
    ID = (int)row["id"]       // Wrong casting
};</p><p>// ? WRONG - Direct ADO.NET
using (var cmd = new NpgsqlCommand(sql, connection)) {
    var reader = cmd.ExecuteReader();
    while (reader.Read()) {
        var id = reader.GetInt32(0);  // Wrong pattern
    }
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>csharp
// Use exact PostgreSQL column names with GetValue<T>
return new Entity {
    ID = row.GetValue<int>("id"),                    // Exact column name
    Name = row.GetValue<string>("name", "default"), // With default
    Amount = row.GetValue<decimal?>("amount")        // Nullable
};</p><p>// Always use XOS data framework
await dbService.GetEntityDataListAsync<Entity>(query, dbParams, (row) => {
    return new Entity { /</em> mapping <em>/ };
});
</code></pre></div></p><p><strong>Reference</strong>: <code>backend/service-complete.cs</code> lines 500-700</p><p>---</p><p><h3>? "404 Not Found" on API endpoints</h3></p><p><strong>What it means</strong>: Wrong HTTP verb or routing pattern.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>csharp
// ? WRONG - Using non-POST verbs
[HttpGet("GetList")]
public async Task<List<Entity>> GetList() { }</p><p>[HttpPut("Update")]
public async Task<bool> Update([FromBody] Entity entity) { }</p><p>// ? WRONG - Missing [FromBody]
[HttpPost("Save")]
public async Task<string> Save(Entity input) { }  // Should be [FromBody]
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>csharp
// 95% of XOS endpoints should be POST
[HttpPost("GetList")]
public async Task<List<Entity>> GetListAsync([FromBody] SearchParams input) { }</p><p>[HttpPost("Save")]
public async Task<string> SaveAsync([FromBody] Entity input) { }</p><p>[HttpPost("Delete")]
public async Task<bool> DeleteAsync([FromBody] IdInput input) { }
</code></pre></div></p><p><strong>Reference</strong>: <code>backend/controller-complete.cs</code> lines 100-200</p><p>---</p><p><h3>? "Object reference not set to an instance of an object" in Services</h3></p><p><strong>What it means</strong>: Missing service base class or incorrect DI registration.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>csharp
// ? WRONG - Not extending XOSServiceBase
public class EntityService : IEntityService {
    // Missing XOS infrastructure - this.GetDBService() won't work
}</p><p>// ? WRONG - Incorrect constructor
public class EntityService : XOSServiceBase {
    public EntityService() { }  // Missing required parameters
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>csharp
// Always extend XOSServiceBase with correct constructor
public class EntityService : XOSServiceBase, IEntityService {
    public EntityService(IServiceProvider serviceProvider, ILogger<EntityService> logger) 
        : base(serviceProvider, logger) { }
        
    // Now this.GetDBService() works
}
</code></pre></div></p><p><strong>Reference</strong>: <code>infrastructure/xos-service-base.cs</code> lines 50-100</p><p>---</p><p><h3>? "Transaction deadlock detected"</h3></p><p><strong>What it means</strong>: SignalR called before transaction commit, or nested transaction issues.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>csharp
// ? WRONG - SignalR before commit
using (var tran = dbService.BeginTransaction()) {
    await SaveData();
    await HubContext.Clients.All.SendAsync("Updated");  // Before commit!
    tran.Commit();
}</p><p>// ? WRONG - Nested using statements
using (var db1 = GetDBService("DB1"))
using (var tran1 = db1.BeginTransaction())
using (var db2 = GetDBService("DB2"))  // Can cause deadlock
using (var tran2 = db2.BeginTransaction()) { }
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>csharp
// Always commit BEFORE SignalR
using (var tran = dbService.BeginTransaction()) {
    try {
        await SaveData();
        tran.Commit();  // COMMIT FIRST
        
        // SignalR AFTER commit
        await HubContext.Clients.All.SendAsync("Updated", data);
    }
    catch {
        tran.Rollback();
        throw;
    }
}
</code></pre></div></p><p><strong>Reference</strong>: <code>database/transactions-complete.cs</code> lines 100-200</p><p>---</p><p><h2>?? API COMMUNICATION ERRORS</h2></p><p><h3>? "CORS policy: No 'Access-Control-Allow-Origin' header"</h3></p><p><strong>What it means</strong>: API call using wrong pattern or absolute URLs.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - Absolute URLs cause CORS
Utils.ajax({
    url: 'http://localhost:5000/api/Entity/Save',  // Absolute URL
    data: input
});</p><p>// ? WRONG - Using fetch/axios instead of Utils.ajax
fetch('/api/Entity/Save', {
    method: 'POST',
    body: JSON.stringify(input)
});
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Always use Utils.ajax with relative URLs
Utils.ajax({
    url: '/api/Entity/Save',  // Relative URL
    data: input
}, (response) => {
    // Success
}, (error) => {
    // Error
});</p><p>// Or with promises
Utils.ajax({
    url: '/api/Entity/Save',
    data: input
}).then(response => {
    // Success
}).catch(error => {
    // Error
});
</code></pre></div></p><p><strong>Reference</strong>: <code>api-patterns/utils-ajax-complete.js</code> lines 50-150</p><p>---</p><p><h3>? "Request timeout" / "API calls hanging"</h3></p><p><strong>What it means</strong>: Missing error handling or incorrect API patterns.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - No error handling
Utils.ajax({
    url: '/api/Entity/Save',
    data: input
});  // What if it fails?</p><p>// ? WRONG - No loading state
async save() {
    const result = await Utils.ajax({ ... });  // User doesn't know it's loading
}
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// Always include loading states and error handling
async save() {
    const model = this.Data;
    model.isLoading = true;
    model.errorMessage = '';
    this.updateUI();
    
    try {
        const result = await Utils.ajax({
            url: '/api/Entity/Save',
            data: model.formData
        });
        
        model.successMessage = 'Saved successfully';
        return result;
    } catch (error) {
        model.errorMessage = error.message || 'Save failed';
        return false;
    } finally {
        model.isLoading = false;
        this.updateUI();
    }
}
</code></pre></div></p><p><strong>Reference</strong>: <code>api-patterns/error-handling-complete.js</code> lines 100-200</p><p>---</p><p><h2>?? STYLING ERRORS</h2></p><p><h3>? "Module not found: Can't resolve '../../../assets/css/theme.css'"</h3></p><p><strong>What it means</strong>: Trying to import theme.css from outside src/ folder.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - Can't import outside src/
import '../../../assets/css/theme.css';
import './assets/theme.css';
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>bash
# First, copy theme.css to src/ folder
cp /path/to/assets/css/theme.css ./src/theme.css
</code></pre></div></p><p><div class="code-block"><pre><code>javascript
// Then import in App.js ONLY
import './theme.css';  // In src/App.js
</code></pre></div></p><p><strong>Reference</strong>: <code>styling/theme-complete.css</code> lines 1-20</p><p>---</p><p><h3>? "Icons not displaying" / "FontAwesome not working"</h3></p><p><strong>What it means</strong>: Using wrong icon class names.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>jsx
// ? WRONG - 'fas' doesn't work in XOS
<i className="fas fa-user"></i>
<i className="fab fa-save"></i>
<i className="fal fa-edit"></i>
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>jsx
// Always use 'fa' class
<i className="fa fa-user"></i>
<i className="fa fa-save"></i>
<i className="fa fa-edit"></i>
<i className="fa fa-trash"></i>
</code></pre></div></p><p><strong>Reference</strong>: <code>styling/bootstrap-complete.html</code> lines 800-900</p><p>---</p><p><h2>?? JQUERY ERRORS</h2></p><p><h3>? "$ is not defined" / "jQuery is not defined"</h3></p><p><strong>What it means</strong>: Trying to remove jQuery or jQuery not loaded properly.</p><p><strong>How it breaks:</strong>
<div class="code-block"><pre><code>javascript
// ? WRONG - Can't remove jQuery
// Attempting to replace with vanilla JS
document.querySelector('.modal').show();  // Won't work with Bootstrap</p><p>// ? WRONG - Loading jQuery incorrectly
import $ from 'jquery';  // May not work with XOS
</code></pre></div></p><p><strong>? CORRECT FIX:</strong>
<div class="code-block"><pre><code>javascript
// jQuery is required and should be globally available
$('.modal').modal('show');    // This should work
$('body').addClass('loading');
$(element).val(newValue);</p><p>// If not available, check your index.html for jQuery script tag
</code></pre></div></p><p><strong>Reference</strong>: <code>jquery-bootstrap/jquery-patterns.js</code> lines 1-50</p><p>---</p><p><h2>?? EMERGENCY FIXES</h2></p><p><h3>Quick Fixes for Common Issues:</h3></p><p><ul><li><strong>Input not working?</strong></li></ul>
   - Add <code>name</code> prop to XOSTextbox
   - Check event handler uses <code>e.value</code> not <code>e.target.value</code>
   - Add <code>updateUI()</code> call</p><p><ul><li><strong>Data property error?</strong></li></ul>
   - Change <code>this.Data = {}</code> to <code>const model = this.Data; model.prop = value</code></p><p><ul><li><strong>API 404?</strong></li></ul>
   - Change to <code>[HttpPost]</code>
   - Add <code>[FromBody]</code> parameter</p><p><ul><li><strong>Database error?</strong></li></ul>
   - Use <code>row.GetValue<T>("column")</code> pattern
   - Check column name case</p><p><ul><li><strong>UI not updating?</strong></li></ul>
   - Add <code>this.VM.updateUI()</code> after data changes</p><p><ul><li><strong>Import error?</strong></li></ul>
   - Use <code>import </em> as cntrl from '../../xos-components'</code></p><p>---</p><p><h2>?? Debugging Strategy</h2></p><p>When something breaks:</p><p><ul><li><strong>Check ABSOLUTE-RULES.md</strong> - Are you following all mandatory patterns?</li><li><strong>Search this file</strong> - Is your error listed above?</li><li><strong>Check the pattern files</strong> - Find the correct implementation</li><li><strong>Compare with working code</strong> - Look at existing modules</li><li><strong>Test incrementally</strong> - Add one feature at a time</li></ul></p><p><h2>?? Pattern File References</h2></p><p>For complete correct patterns, see:
<ul><li>Frontend issues ? <code>frontend/component-complete.jsx</code>, <code>frontend/viewmodel-complete.jsx</code></li><li>Backend issues ? <code>backend/service-complete.cs</code>, <code>backend/controller-complete.cs</code></li><li>API issues ? <code>api-patterns/utils-ajax-complete.js</code></li><li>Styling issues ? <code>styling/bootstrap-complete.html</code></li><li>Database issues ? <code>database/postgres-queries.sql</code></li></ul></p><p><strong>Remember</strong>: Every error above has a working solution in the pattern files. When in doubt, copy the pattern exactly and modify for your needs.</p>
            
            <div class="footer">
                <p><em>Auto-generated from Markdown</em><br>
                <em>Part of XOS Framework Documentation</em></p>
            </div>
        </main>
    </div>

    <script>
        // Copy code functionality
        function copyCode(button, codeId) {
            const codeElement = document.getElementById(codeId);
            const text = codeElement.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Collapsible sections
        function toggleCollapsible(header) {
            const collapsible = header.parentElement;
            collapsible.classList.toggle('expanded');
        }
    </script>
</body>
</html>
